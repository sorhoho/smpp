"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const haredo_1 = require("../haredo");
const index_1 = require("../index");
const bluebird_1 = require("bluebird");
const main = async () => {
    const chain = haredo_1.haredo({
        connection: 'amqp://guest:guest@localhost:5672/'
    });
    const queue = index_1.q('test').expires(2000);
    await chain.queue(queue)
        .subscribe(({ data }) => {
        console.log(data);
    });
    let i = 1;
    while (true) {
        await chain.queue(queue).publish({ test: i, time: Date.now() });
        await bluebird_1.delay(500);
        i += 1;
    }
};
process.nextTick(main);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltcGxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2V4YW1wbGVzL3NpbXBsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHNDQUFtQztBQUNuQyxvQ0FBNkI7QUFDN0IsdUNBQWlDO0FBRWpDLE1BQU0sSUFBSSxHQUFHLEtBQUssSUFBSSxFQUFFO0lBQ3BCLE1BQU0sS0FBSyxHQUFHLGVBQU0sQ0FBQztRQUNqQixVQUFVLEVBQUUsb0NBQW9DO0tBQ25ELENBQUMsQ0FBQztJQUNILE1BQU0sS0FBSyxHQUFHLFNBQUMsQ0FBaUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3RFLE1BQU0sS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUM7U0FDbkIsU0FBUyxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFO1FBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQyxDQUFDLENBQUM7SUFDUCxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDVixPQUFPLElBQUksRUFBRTtRQUNULE1BQU0sS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQ2hFLE1BQU0sZ0JBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqQixDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ1Y7QUFDTCxDQUFDLENBQUM7QUFFRixPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDIn0=